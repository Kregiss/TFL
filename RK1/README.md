## Вариант 11

### 1 номер
Задание:

Древесный язык логических формул со связками ¬, & и булевскими константами, не содержащих двойных отрицаний.

--------
Решение:

Пусть $T, F \to q_B(x)$

Тогда

$¬(q_B(x)) \to q_N(¬x)$

$\\&(q_∀(x), q_∀(y)) \to q_\\&(\\&(x, y))$, где ∀ $\in$ {B, N, \&}

$¬(q_\\&(x)) \to q_N(¬x)$

$¬(q_N(x)) \to q_E(¬x)$ -- состояние ловушки

$¬(q_E(x)) \to q_E(¬x)$

$\\&(q_E(x), q_∀(y)) \to q_E(\\&(x, y))$

$\\&(q_E(x), q_E(y)) \to q_E(\\&(x, y))$

Финальные состояния $Q_F = \\{ q_B, q_N, q_\\& \\}$.

Таким образом, построили конечный детерминированный автомат снизу вверх для этого языка. Следовательно, язык регулярен.

-----
### 2 номер
Задание:

Язык слов $L = \\{w_1w_2w_3 | w_1=h(w_3) \\& |w_1| > 0\\}, h(a) = aa, h(b) = ab$.

------

Решение:

Пусть L - регулярный язык. Тогда по лемме о накачке для регулярных языков существует константа накачки p. 
Возьмём $w_3 = a^pb$. $h(a^pb) = a^{2p}ab = a^{2p + 1}b$. Значит итоговое слово равно $w = a^{2p + 1}ba^pb$ ($w_2$ - пустое).
$|w| = (2p + 1) + 1 + p + 1 = 3p + 3 >= p $.

По лемме существует такое разбиение w = xyz, что |xy| <= p, |y| > 0. Т.к. |xy| <= p, то xy полностью лежат в в первых p 
символах слова, т.е. в первых p штуках буквы a (т.к. слово начинается с $a^{2p + 1}$). Следовательно y состоит только из a.
При любой накачке y соотношение $a^{2p}$ в начале слова и $a^p$ в конце нарушится. Т.е. $xy^iz$ для любого i не принадлежит языку L. 

Противоречие лемме о накачке, следовательно язык не регулярный.

-----
### 3 номер
Задание:

Язык $L = \\{w_1w_2 | |w_1|\_{a^4} = |w_2|\_{a^2} \\& |w_1| = |w_2|\\}$.

-----
Решение:

Пересечём этот язык с регулярным языком $a^+b^+a^+b^+$. Возьмём слова вида $a^{p+4}b^pa^{p+2}b^{p+2}$, в нём $|w_1|\_{a^4} = |w_2|\_{a^2}=p+1$.

Пусть L - КС язык. Тогда по лемме о накачке для КС языков существует константа накачки p.
Возьмём слово: $w = a^{p+4}b^pa^{p+2}b^{p+2}$.

По лемме существует такое разбиение w = xvwuy, что $|vwu| <= p$, $|vu| > 0$. Т.к. $|vwu| <= p$, то этот отрезок лежит:
1) полностью в блоке $a^{p+4}$. При i=0, слово станет $a^{p-k+4}b^pa^{p+2}b^{p+2}, 1<=k<=p$. Его новое разбиение на половины возможно только в случае, если k чётно (потому что возможен чётное-...=чётное только в случае ...=чётное) (иначе его нельзя разбить на две половины, автоматически слово не из языка): $w_1^0=a^{p-k+4}b^{p}a^{k/2}$ и $w_2^0=a^{p-k/2+2}b^{p+2}$. При этом $|w_1^0|\_{a^4}=(p-k+4-3)+(k/2-3)$, если $k/2 >= 3$, иначе $(k/2-3)=0$, $|w_2^0|\_{a^2}=p-k/2+2-1$. Итак
   - $p-k+1=p-k/2+1, k < 6$, т.е. $k=k/2$ - возможно только при $k = 0 = |vwu|$, т.е. противоречие лемме;
   - $p-k+1+k/2-3=p-k/2+1, k >= 6$, т.е. $-2=1$ невозможно, т.е. противоречие лемме.
2) полностью в блоке $b^p$:
   - Если k - нечётное, $i=2$, то получаем слово $w^0=a^{p+4}b^{p+k}a^{p+2}b^{p+2}$ - его длина нечётная, слово не из языка - противоречие лемме.
   - Если k - чётное, $i=0$, то получаем слово $w^0=a^{p+4}b^{p-k}a^{p+2}b^{p+2}$. Разбиение на две половины: $w_1^0=a^{p+4}b^{p-k}a^{k/2}$ и $w_2^0=a^{p-k/2+2}b^{p+2}$. Для них соответственно $|w_1^0|\_{a^4}=(p+4-3)+(k/2-3)$, если $k/2 >= 3$, иначе $(k/2-3)=0$ и $|w_2^0|\_{a^2}=p-k/2+2-1$. Получаем $p+4-3=p-k/2+2-1$ (здесь даже и не надо прибавлять возможные $a^4$, которые добавились после $b^{p-k}$, доказательство работает и так), т.е. $p+1=p-k/2+1$, а т.к. $1<=k<=p$, то при любой длине накачки это равенство не будет выполняться. Слово не принадлежит языку. Противоречие лемме.
3) полностью в блоке $a^{p+2}$. Сразу отбрасываем случай, когда k нечётно (его рассмотрели ранее). Пусть k чётно, $i=0$, тогда получается слово $w^0=a^{p+4}b^{p}a^{p+2-k}b^{p+2}$. И его разбиение: $w_1^0=a^{p+4}b^{p-k/2}$ и $w_2^0=b^{k/2}a^{p+2-k}b^{p+2}$. И здесь количество $a^4$ в первой половине не изменится, а количество $a^2$ во второй половине уменьшится, т.е. слово выпадет из языка. Противоречие лемме.
4) полностью в блоке $b^{p+2}$. Пусть k чётное, i=2. Тогда $w^0=a^{p+4}b^{p}a^{p+2}b^{p+2+k}$, его разбиение равно $w_1^0=a^{p+4}b^{p}a^{k/2}$ и $w_2^0=a^{p+2-k/2}b^{p+2+k}$. Посчитаем $|w_1^0|\_{a^4}=(p+4-3)+(k/2-3)$, если $k/2 >= 3$, иначе $(k/2-3)=0$ и $|w_2^0|\_{a^2}=p+2-k/2-1$. Получаем (можем не считать $(k/2-3)$ - и без него будет доказываться) $p+4-3=p+2-k/2-1$, т.е. $0=k/2$, что возможно только при k=0 - противоречие лемме.
5) на стыке $a^{p+4}b^p$ (ни один фрагмент полностью не содержит). Пусть k чётно, i=2. Получаем слово $w^0=a^{p+4+k_1}b^{p+k_2}a^{p+2}b^{p+2}, k_1+k_2=k$ и его разбиение $w_1^0=a^{p+4+k_1}b^{p+k_2-k/2}$ и $w_2^0=b^{k/2}a^{p+2}b^{p+2}$. При этом количество $a^4$ в первой половине увеличилось, а количество $a^2$ во второй не изменилось. Слово выпало из языка. Противоречие лемме.
6) на стыке $b^pa^{p+2}$ (ни один фрагмент полностью не содержит). Пусть k чётно, i=0. Получаем слово $w^0=a^{p+4}b^{p-k_1}a^{p+2-k_2}b^{p+2}, k_1+k_2=k$ и его разбиение:
   - если $k_1>k_2$, то часть a из $a^{p+2-k_2}$ перетечёт в первую половину. И тогда количество $a^4$ в первой половине увеличилось или не изменилось (если количество перетёкших a меньше 4), а количество $a^2$ во второй уменьшилось. Слово выпало из языка. Противоречие лемме.
   - если $k_1<k_2$, то часть b из $b^{p-k_1}$ перетечёт во вторую половину. И количество $a^4$ в первой половине не изменилось, а количество $a^2$ во второй уменьшилось. Слово выпало из языка. Противоречие лемме.
   - если $k_1=k_2$, то получаем разбиение $w_1^0=a^{p+4}b^{p-k_1}$ и $w_2^0=a^{p+2-k_1}b^{p+2}$ и количество $a^4$ в первой половине не изменилось, а количество $a^2$ во второй уменьшилось. Слово выпало из языка. Противоречие лемме.
7) на стыке $a^{p+2}b^{p+2}$ (ни один фрагмент полностью не содержит). Пусть k чётно, i=0. Получаем слово $w^0=a^{p+4}b^{p}a^{p+2-k_1}b^{p+2-k_2}, k_1+k_2=k$ и его разбиение $w_1^0=a^{p+4}b^{p-k/2}$ и $w_2^0=b^{k/2}a^{p+2-k_1}b^{p+2}$. При этом количество $a^4$ в первой половине не изменилось, а количество $a^2$ во второй уменьшилось. Слово выпало из языка. Противоречие лемме.

Значит во всех возможных разбиениях w = xvwuy есть i, для которого $xv^iwu^iy$ не принадлежит языку. Это противоречит лемме.
Следовательно язык не КС.





