## Вариант 8

### 1 номер
Задание:

Язык SRS с правилами $aba \to bbab, abb \to bbaa, abb \to bba$ над базисом $a^nba^n$.

--------
Решение:

Применим максимальное количество раз правило $aba \to bbab$ к базису. Получаем слово вида $a^{n-1}(bb)^nab$. К нему также можно применить правила $abb \to bbaa$ или $abb \to bba$, которые последовательно сдвигают bb в начало строки (разница в них - увеличивается ли количество a в два раза после их сдвига или нет). Таким образом получаем слово вида $(bb)^na^{n-1}ab$ (если количество a не увеличивалось) или $(bb)^na^{2^n(n-1)}ab$ (т.к. за каждый свой проход каждая bb увеличивала количество a, которые были перед ней, в 2 раза). Т.е. количество a после в полученной НФ варьируется между максимальным значением: $2^n(n-1)+1$, и минимальным: n.

Пересечём изначальный язык L с регулярным языком $R=b^\*a^\*b$. Возьмём слова из полученного пересечения P вида $(bb)^na^{2^n(n-1)}ab$ и применим лемму о накачке для КС языков. 

Пусть P - КС язык. Тогда по лемме о накачке для КС языков существует константа накачки p.
Возьмём слово: $w = (bb)^{p}a^{2^p(p-1)+1}b$.

По лемме существует такое разбиение w = xvwuy, что $|vwu| <= p$, $|vu| > 0$. Т.к. $|vwu| <= p$, то этот отрезок лежит:
1) полностью в блоке $(bb)^{p}$. При i=0 получается слово $w_0=b^{2p-k}a^{2^p(p-1)+1}b, 1<=k<=p$. Если k нечётно - слово автоматически выпало из языка. Если k чётно, то для слова из P при фиксированном числе начальных bb (в данном случае 2p-k) допустимо не больше $2^{p-k/2}(p-k/2-1)+1$ штук a, что меньше чем $2^{p}(p-1)+1$. Слово выпало из языка P. Противоречие лемме.
2) полностью в $a^{2^p(p-1)+1}$. При i=2 получается слово $w_0=b^{2p}a^{2^p(p-1)+1+k}b$. Для слова из P при фиксированном числе начальных bb (в данном случае 2p) допустимо не больше $2^{p}(p-1)+1$ штук a, что меньше чем $2^{p}(p-1)+1+k$. Слово выпало из языка P. Противоречие лемме.
3) На стыке $(bb)^{p}a^{2^p(p-1)+1}$ (полностью ни один блок не содержит). При i=0 получаем слово $w_0=b^{2p-k_1}a^{2^p(p-1)+1-k_2}b, k_1+k_2=k, k_1>=1, k_2>=1$. Тогда $k_1$ чётно (иначе - рассмотрено в пункте 1)), тогда количество букв b равно $2p-k_1$ и для них соответственно может быть не больше чем $2^{p-k_1/2}(p-1-k_1/2)+1$ букв a. Это возможно только при  $2^{p-k_1/2}(p-1-k_1/2)>=2^p(p-1)-k_2$. Оценим разность $2^p(p-1)-2^{p-k_1/2}(p-1-k_1/2)=2^{p-k_1/2}(2^{k_1/2}(p-1)-(p-1-k_1/2))$. Т.к. $k_1>=2$ (потому что чётное), то $2^{k_1/2}(p-1)-(p-1-k_1/2)>=p$, а значит $2^{p}(p-1)+1-k_2>2^{p-k_1/2}(p-1-k_1/2)+1$, для любого $1<=k_2<=p$ (т.е. a слишком много). Противоречие лемме.
4) На стыке $a^{2^p(p-1)+1}b$ (полностью блок $a^{2^p(p-1)+1}$ не содержит). При i=0 исчезает последняя b, и слова вида $(bb)^{p}a^{2^p(p-1)+1-k_1}$, где $k_1 + 1 = k$ не принадлежат P. Противоречие лемме.

Значит во всех возможных разбиениях w = xvwuy есть i, для которого $xv^iwu^iy$ не принадлежит языку. Это противоречит лемме.
Следовательно язык P не КС. А значит и изначальный язык L не КС.



--------
### 2 номер
Задание:

Язык $\\{a^\*a^kb^nc^ma^i | (k + n = m^2) ∨ (n > m \\& k < i)\\}$.

--------
Решение:

Пересечём этот язык L с регулярным языком $R=a^\*c^\*$. Получаем слова вида $a^\*a^kc^m$, и соответственно $n=i=0$, а условия стали такими: $(k = m^2) ∨ (0 > m \\& k < 0)$. Второе условие всегда ложно, значит осталось только первое условие. Таким образом надо проверить является ли КС язык $\\{ a^tc^m | t >= m^2\\}$. 

Применим лемму о накачке для данного пересечения и выберем слово вида $w=a^{p^2}c^p$, где p - константа накачки. По лемме существует такое разбиение w = xvwuy, что $|vwu| <= p$, $|vu| > 0$. Т.к. $|vwu| <= p$, то этот отрезок лежит:
1) полностью в блоке $a^{p^2}$. Пусть i=0, тогда получим слово $w_0=a^{p^2-k}c^p, 1<=k<=p$, и соотношение $p^2-k>=p^2$ выполняется только когда k<=0 (но $1<=k<=p$). Противоречие лемме.
2) полностью в блоке $c^p$. Пусть i=2, тогда получаем слово вида: $w_0=a^{p^2}c^{p+k}$, и опять соотноешние $p^2>=(p+k)^2=p^2+2pk+k^2$ выполняется только при k<=0, что невозможно. Противоречие лемме.
3) На стыке $a^{p^2}c^p$ (полностью ни один блок не содержит). При i=2 получаем слово $w_0=a^{p^2+k_1}c^{p+k_2}, k_1+k_2=k, k_1>=1, k_2>=1$. Чтобы слово было в языке, необходимо выполнение $p^2+k_1>=(p+k_2)^2=p^2+2pk_2+k_2^2$, т.е. чтобы $k_1=2pk_2+k_2^2>=2p+1$, что невозможно, т.к. $k_1<p$. Противоречие лемме.

Значит во всех возможных разбиениях w = xvwuy есть i, для которого $xv^iwu^iy$ не принадлежит языку пересечения L с регулярным. Это противоречит лемме.
Следовательно язык пересечения L с регулярным не КС. А значит и сам язык L не КС (т.к. КС языки замкнуты относительно пересечения с регулярными).

А значит L не является и DCFL.


--------
### 3 номер
Задание:

Язык, определяемый следующей атрибутной грамматикой:

$S \to SaS   ;    S_0.attr:=S_1.attr+S_2.attr,  S_2.attr \\ne S_1.attr$

$S \to b    ;    S.attr:=1$

$S \to bA   ;    S.attr:=A.attr$

$A \to aAa  ;    A_0.attr:=A_1.attr+2$

$A \to b   ;     A.attr:=0$

--------
Решение:

Нетерминал A порождает подслова вида $a^nba^n$, и значение атрибута для него будет равно 2n - количество a в нём. Нетерминал S порождает слова вида $ba^nba^nab$, $baba^nba^n$, $ba^nba^naba^mba^m, n \\ne m$ и т.д. и значение атрибута для него равно сумме неравных атрибутов S, из которых он состоит.

Возьмём слова из этого языка вида $ba^nba^naba^{n+2}ba^{n+2}$, полученные путём пересечения изначального языка с регулярным языком $R=ba^\*ba^+ba^\*ba^*$.

Пусть L - КС язык. Тогда по лемме о накачке для КС языков существует константа накачки p.
Возьмём слово: $w = ba^pba^paba^{p+2}ba^{p+2}$.
По лемме существует такое разбиение w = xvwuy, что $|vwu| <= p$, $|vu| > 0$. Т.к. $|vwu| <= p$, то этот отрезок лежит:
1) полностью внутри блока $a^p$ или $a^{p+2}$. При i=0 нарушается взаимосвязь с блоком по другую сторону от b, т.е. с $a^p$ или $a^{p+2}$ соответственно. Слово выпадает из языка. Противоречие лемме.
2) на стыке только одного из блоков $a^p$ или $a^{p+2}$ с b или с одиночной a после второго $a^p$. При i=0 эти b или одиночная a пропадают и слово уже не принадлежит языку. Противоречие лемме.

Значит во всех возможных разбиениях w = xvwuy есть i, для которого $xv^iwu^iy$ не принадлежит языку L. Это противоречит лемме.

Следовательно, язык L не КС.

